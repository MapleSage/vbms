"use strict";(()=>{var e={};e.id=669,e.ids=[669],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},468:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>h,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>v});var a={};r.r(a),r.d(a,{GET:()=>l,POST:()=>p});var n=r(9303),s=r(8716),o=r(670),i=r(7070),u=r(3493);async function l(e){try{let{searchParams:t}=new URL(e.url),r=t.get("status"),a=await u._.van.findMany({where:r?{status:r}:void 0,orderBy:{vanId:"asc"},include:{_count:{select:{bookings:!0,maintenance:!0}}}});return i.NextResponse.json(a)}catch(e){return console.error("Error fetching vans:",e),i.NextResponse.json({error:"Failed to fetch vans"},{status:500})}}async function p(e){try{let t=await e.json();for(let e of["vanId","registration","make","model","year","tier","type","dailyRate","mileageRate"])if(!t[e])return i.NextResponse.json({error:`Missing required field: ${e}`},{status:400});if(await u._.van.findFirst({where:{OR:[{vanId:t.vanId},{registration:t.registration}]}}))return i.NextResponse.json({error:"Van ID or Registration already exists"},{status:409});let r=await u._.van.create({data:{vanId:t.vanId,registration:t.registration,make:t.make,model:t.model,year:parseInt(t.year),vin:t.vin||null,tier:t.tier,type:t.type,dailyRate:parseFloat(t.dailyRate),mileageRate:parseFloat(t.mileageRate),status:t.status||"AVAILABLE",configuration:t.configuration||null,accessories:t.accessories||null,photoUrl:t.photoUrl||null}});return i.NextResponse.json(r,{status:201})}catch(e){return console.error("Error creating van:",e),i.NextResponse.json({error:"Failed to create van"},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/vans/route",pathname:"/api/vans",filename:"route",bundlePath:"app/api/vans/route"},resolvedPagePath:"/Volumes/Macintosh HD Ext/VBMS/vbms-app/app/api/vans/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:c,staticGenerationAsyncStorage:v,serverHooks:g}=d,m="/api/vans/route";function h(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:v})}},3493:(e,t,r)=>{r.d(t,{_:()=>n});let a=require("@prisma/client"),n=globalThis.prisma??new a.PrismaClient({log:["error"]})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[276,972],()=>r(468));module.exports=a})();